# Phase 11.1: Auth, Authorization, and Marketing Landing Page - Context

**Gathered:** 2026-02-20
**Status:** Ready for planning

<domain>
## Phase Boundary

The full client acquisition circle works end-to-end: prospect lands on marketing site → picks a plan → submits payment screenshot (InstaPay/Vodafone Cash) → completes Clerk signup via magic link → awaits coach approval → gets approved → completes initial assessment. Coach users are identified via Clerk roles and can access the admin panel. Client users are gated by approval status. Rejected users get notified with a reason and their accounts are cleaned up.

</domain>

<decisions>
## Implementation Decisions

### Marketing Page Design
- Page must feel natural and consistent with the client app — same royal blue theme, same design language. It's the front door to the product, not a separate marketing site.
- Sections: Hero → Feature highlights (AI plans, check-ins, tracking) → Pricing → Trust signals/testimonials
- Bilingual (EN + AR) using same next-intl setup as client app, with RTL support and language switcher
- Lives as `apps/marketing/` — 3rd monorepo app

### Checkout & Payment Flow
- Checkout opens as a modal/drawer overlay when user clicks a pricing plan (not a separate page)
- Form fields: name, email, phone number, payment screenshot upload
- Payment screenshot upload: drag-and-drop zone on desktop, tap-to-upload on mobile, with preview before submit
- Payment methods are coach-configurable — coach sets their InstaPay/Vodafone Cash/etc. account details in admin settings, checkout form dynamically displays whatever is configured

### Approval & Onboarding Handoff
- **Full signup flow:**
  1. Prospect fills checkout form (name, email, phone, payment screenshot) → stored in Convex as signup record (NO Clerk account yet)
  2. Confirmation page: "Check your email to complete signup"
  3. Clerk magic link email → prospect clicks, sets password → Clerk account created
  4. User lands on pending approval page (logged in but gated) — similar to existing design with status stepper
  5. **On approval:** Email notification + page auto-transitions to initial assessment (Convex real-time subscription, no manual refresh needed)
  6. **On rejection:** Email with coach's rejection reason + Clerk account deleted + DB records cleaned up
- Pending page uses Convex real-time subscription — updates instantly when coach makes a decision, no "Check Status" button needed
- Stepper shows: "Signup Complete ✓ → Under Review (current) → Approval Notification (pending)"

### Admin Approval Interface
- Both list view and detail view for signups
- Table overview with quick Approve button per row
- Click into detail view to inspect payment screenshot closely before approving
- Reject opens a reason input field — reason is included in rejection email to the client

### Pricing Plans & Tiers
- Plans are coach-configurable from admin settings (not hardcoded)
- Max 4 plans to keep pricing section clean
- Each plan has: name, price, duration, feature bullet list, optional highlight badge ("Most Popular", "Best Value")
- Plans are display-only for pricing — all approved clients get the same features regardless of tier
- Plan data stored in Convex, landing page reads dynamically

### Claude's Discretion
- Pricing card layout style (side-by-side, toggle, etc.)
- Loading skeletons and transition animations
- Exact trust signals / testimonials section design
- Error states and edge case handling
- Marketing page mobile responsive breakpoints
- Approval email template design

</decisions>

<specifics>
## Specific Ideas

- Pending approval page should look similar to the existing design (screenshot reference provided) — status stepper with icon indicators, current status badge, and info text
- Key difference from existing: assessment step comes AFTER approval, not before. Stepper reflects this order.
- "Approval typically takes 24-48 hours" messaging at the bottom of pending page

</specifics>

<research>
## Research Questions

- **Clerk subscription/plan features:** Investigate whether Clerk's built-in subscription/plan capabilities can be used for this flow (InstaPay/Vodafone Cash manual payments + coach approval/rejection). Determine if custom Convex-based plan management is the better path, or if Clerk's features can handle the manual payment verification model.
- **Clerk magic link + delayed account creation:** Verify the best Clerk flow for: checkout form collects email → Clerk sends magic link → user sets password → account created. Ensure this works with the "signup record exists in Convex before Clerk account" pattern.

</research>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 11.1-auth-and-authorization-clerk-roles-coach-detection-client-subscription-journey*
*Context gathered: 2026-02-20*
