---
phase: 11.1-auth-and-authorization-clerk-roles-coach-detection-client-subscription-journey
plan: 02
subsystem: ui
tags: [next-intl, convex, tailwindcss, marketing, i18n, rtl]

# Dependency graph
requires: []
provides:
  - "@fitfast/marketing Next.js app on port 3002"
  - "EN/AR locale routing with RTL support (next-intl only, no Clerk)"
  - "Unauthenticated Convex provider for public pricing data access"
  - "Royal blue design tokens shared with client app"
  - "Placeholder landing page with @fitfast/ui Button integration verified"
affects:
  - 11.1-03-marketing-landing-page
  - 11.1-04-checkout-flow

# Tech tracking
tech-stack:
  added:
    - "@fitfast/marketing (new monorepo app on port 3002)"
    - "convex/react ConvexProvider (unauthenticated, no Clerk)"
  patterns:
    - "Public app pattern: next-intl middleware only, no Clerk dependency"
    - "ConvexProvider (not ConvexProviderWithClerk) for unauthenticated apps"
    - "getTranslations server-side for server component pages"
    - "Same globals.css design tokens across all monorepo apps"

key-files:
  created:
    - apps/marketing/package.json
    - apps/marketing/next.config.ts
    - apps/marketing/tsconfig.json
    - apps/marketing/postcss.config.mjs
    - apps/marketing/middleware.ts
    - apps/marketing/src/i18n/routing.ts
    - apps/marketing/src/i18n/request.ts
    - apps/marketing/src/app/globals.css
    - apps/marketing/src/app/layout.tsx
    - apps/marketing/src/app/[locale]/layout.tsx
    - apps/marketing/src/app/[locale]/page.tsx
    - apps/marketing/src/components/providers/convex-provider.tsx
    - apps/marketing/src/messages/en.json
    - apps/marketing/src/messages/ar.json
  modified:
    - package.json (added dev:marketing script)
    - pnpm-lock.yaml

key-decisions:
  - "Used plain ConvexProvider (not ConvexProviderWithClerk) — marketing app is fully public, no auth needed"
  - "Used getTranslations (server-side) instead of useTranslations (client hook) for landing page — preserves server component benefits"
  - "Copied globals.css design tokens verbatim from client app — ensures visual consistency across all 3 apps"
  - "No Sentry or PWA plugins in next.config.ts — marketing app does not need error monitoring or offline support"
  - "Added getStarted key to messages (beyond plan spec) — needed for CTA button on landing page"

patterns-established:
  - "Public app pattern: middleware.ts uses createMiddleware(routing) only — no Clerk protectRoute wrapping"
  - "ConvexClientProvider for marketing wraps with plain ConvexProvider — unauthenticated apps skip ConvexProviderWithClerk"
  - "All apps share identical globals.css design tokens — single source of truth for royal blue theme"

requirements-completed:
  - MARKETING-SCAFFOLD
  - MARKETING-BILINGUAL

# Metrics
duration: 19min
completed: 2026-02-20
---

# Phase 11.1 Plan 02: Marketing App Scaffold Summary

**Next.js marketing app on port 3002 with EN/AR RTL routing, plain Convex provider (no Clerk), and royal blue design tokens shared with the client app**

## Performance

- **Duration:** 19 min
- **Started:** 2026-02-20T19:36:09Z
- **Completed:** 2026-02-20T19:55:03Z
- **Tasks:** 2
- **Files modified:** 16

## Accomplishments
- Marketing app (`@fitfast/marketing`) added as 3rd monorepo member, built and type-checked successfully
- EN/AR locale routing via next-intl middleware only — no Clerk dependency (fully public app)
- Plain `ConvexProvider` (not `ConvexProviderWithClerk`) for unauthenticated pricing data access
- Royal blue design tokens (`globals.css`) copied verbatim from client app for visual consistency
- `@fitfast/ui/button` integration verified on placeholder landing page

## Task Commits

Each task was committed atomically:

1. **Task 1: Create marketing app package and configuration files** - `97150a8` (feat)
2. **Task 2: Create marketing app layouts, Convex provider, and placeholder page** - `832455e` (feat)

**Plan metadata:** (pending final docs commit)

## Files Created/Modified

- `apps/marketing/package.json` - @fitfast/marketing with next, next-intl, convex, @fitfast/ui deps
- `apps/marketing/next.config.ts` - next-intl plugin, transpilePackages, no Sentry/PWA
- `apps/marketing/tsconfig.json` - extends @fitfast/config, convex path alias
- `apps/marketing/postcss.config.mjs` - @tailwindcss/postcss for Tailwind v4
- `apps/marketing/middleware.ts` - next-intl createMiddleware only (no Clerk)
- `apps/marketing/src/i18n/routing.ts` - en/ar locales with localePrefix always
- `apps/marketing/src/i18n/request.ts` - load messages by locale
- `apps/marketing/src/app/globals.css` - full royal blue design token set (identical to client)
- `apps/marketing/src/app/layout.tsx` - root layout with locale-aware html dir/lang, font loading
- `apps/marketing/src/app/[locale]/layout.tsx` - locale layout with NextIntlClientProvider + ConvexClientProvider
- `apps/marketing/src/app/[locale]/page.tsx` - placeholder landing page with Button from @fitfast/ui
- `apps/marketing/src/components/providers/convex-provider.tsx` - plain ConvexProvider (no Clerk)
- `apps/marketing/src/messages/en.json` - English landing translations
- `apps/marketing/src/messages/ar.json` - Arabic landing translations
- `package.json` - added dev:marketing script
- `pnpm-lock.yaml` - updated with marketing app dependencies

## Decisions Made
- Used plain `ConvexProvider` (not `ConvexProviderWithClerk`) — marketing is a public app, no authentication needed
- Used `getTranslations` (server-side async) instead of `useTranslations` (client hook) — preserves server component rendering for the landing page
- Copied `globals.css` design tokens verbatim from client app — single source of truth approach, ensures all 3 apps look identical
- No Sentry or PWA plugins — marketing app does not need error monitoring or offline support at this stage

## Deviations from Plan

**1. [Rule 2 - Missing Critical] Added `getStarted` translation key**
- **Found during:** Task 2 (placeholder page)
- **Issue:** Plan spec only included title/subtitle/comingSoon keys, but the Button CTA needed a label
- **Fix:** Added `getStarted` key to both en.json and ar.json
- **Files modified:** apps/marketing/src/messages/en.json, apps/marketing/src/messages/ar.json
- **Verification:** Build passes, translations render correctly
- **Committed in:** 832455e (Task 2 commit)

---

**Total deviations:** 1 auto-fixed (1 missing critical translation key)
**Impact on plan:** Minor addition, required for Button component to have a label. No scope creep.

## Issues Encountered
None - plan executed smoothly. Build and type-check both passed on first attempt.

## User Setup Required
None - no external service configuration required. The `NEXT_PUBLIC_CONVEX_URL` env var will be shared with client/admin apps (same Convex deployment).

## Next Phase Readiness
- Marketing app scaffold is complete and ready for landing page content
- Shared design tokens and i18n infrastructure verified working
- @fitfast/ui component integration confirmed via Button on landing page
- No blockers

## Self-Check: PASSED

All 14 created files verified present on disk. Both task commits (97150a8, 832455e) verified in git log.

---
*Phase: 11.1-auth-and-authorization-clerk-roles-coach-detection-client-subscription-journey*
*Completed: 2026-02-20*
